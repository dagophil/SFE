#ifndef SFE_GAME_HXX
#define SFE_GAME_HXX

#include <SFML/Graphics.hpp>

#include "screen.hxx"

namespace sfe
{
    ////////////////////////////////////////////////////////////
    /// Base class for all game applications.
    ////////////////////////////////////////////////////////////
    class Game
    {
    public:

        ////////////////////////////////////////////////////////////
        /// Initialize the game.
        ////////////////////////////////////////////////////////////
        Game(unsigned int width, unsigned int height, std::string const & title, sf::Uint32 style = sf::Style::Default);

        ////////////////////////////////////////////////////////////
        /// Run the game loop.
        ////////////////////////////////////////////////////////////
        void run();

        ////////////////////////////////////////////////////////////
        /// Return the render window.
        ////////////////////////////////////////////////////////////
        sf::RenderWindow & get_window();

        ////////////////////////////////////////////////////////////
        /// Return the render window.
        ////////////////////////////////////////////////////////////
        sf::RenderWindow const & get_window() const;

        ////////////////////////////////////////////////////////////
        /// The initialization method, which is automatically called
        /// at the beginning of run().
        ////////////////////////////////////////////////////////////
        std::function<void()> init_;

        ////////////////////////////////////////////////////////////
        /// The update method, which is automatically called once
        /// per frame.
        ////////////////////////////////////////////////////////////
        std::function<void(sf::Time)> update_;

        ////////////////////////////////////////////////////////////
        /// Load the given screen.
        ////////////////////////////////////////////////////////////
        void load_screen(std::unique_ptr<Screen> new_screen, bool change_to_default_view = true);

    private:

        ////////////////////////////////////////////////////////////
        /// The current screen.
        ////////////////////////////////////////////////////////////
        std::unique_ptr<Screen> screen_;

        ////////////////////////////////////////////////////////////
        /// The new requested screen. The pointer is only valid
        /// between a call to load_screen() and the next frame.
        ////////////////////////////////////////////////////////////
        std::unique_ptr<Screen> requested_screen_;

        ////////////////////////////////////////////////////////////
        /// The render window.
        ////////////////////////////////////////////////////////////
        sf::RenderWindow window_;

        ////////////////////////////////////////////////////////////
        /// The clock that measures the elapsed time per frame.
        ////////////////////////////////////////////////////////////
        sf::Clock clock_;

    }; // class Game

} // namespace sfe

#endif
